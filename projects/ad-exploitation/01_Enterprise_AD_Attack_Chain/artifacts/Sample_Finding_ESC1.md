# Sample Security Finding: ADCS Template Misconfiguration

**Finding ID:** AD-FIND-001  
**Severity:** Critical üî¥  
**MITRE ATT&CK Technique:** [T1558.003](https://attack.mitre.org/techniques/T1558/003/) - Steal or Forge Kerberos Tickets: Kerberos Bronze Bit  
**Affected Component:** Active Directory Certificate Services (ADCS) - Certificate Template  

## üìã Observation
A certificate template (`VulnerableTemplate`) was identified with the following misconfigurations:
1.  **Enrollment Rights:** Granted to standard domain user groups.
2.  **Enrollee Supplies Subject:** Enabled, allowing requesters to specify an arbitrary Subject Alternative Name (SAN).
3.  **Manager Approval:** Not required.

## üéØ Impact Analysis
This combination allows any enrolled user to request a certificate that authenticates as **any other domain user**, including privileged accounts (Domain Administrators, Enterprise Admins). Successful exploitation leads to:
- **Immediate Domain Compromise** via identity impersonation
- **Persistence** through valid, trusted certificates
- **Bypass** of traditional credential-based detection controls

**Business Impact:** Complete loss of trust in PKI infrastructure, potential regulatory compliance violations, and total organizational network compromise.

## üîß Proof of Concept (Sanitized)
1.  **Enumerate vulnerable templates:** `certipy find -u user@domain.local -p Password123`
2.  **Request certificate with escalated SAN:** `certipy req -ca CA-SERVER -template VulnerableTemplate -upn administrator@domain.local`
3.  **Authenticate using certificate:** `certipy auth -pfx administrator.pfx`
4.  **Result:** Obtains TGT for Domain Administrator account.

## üõ†Ô∏è Remediation Steps
### Immediate (Within 24 Hours)
1.  Modify the `VulnerableTemplate` properties:
    - Set **"Enrollee Supplies Subject"** to `Disabled`.
    - Review and restrict **"Enrollment Rights"** to authorized security principals only.
2.  Audit all certificate templates for similar misconfigurations using PowerShell: `Get-ADObject -SearchBase "CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=..." -Filter * -Properties * | Select Name, enrolleeSuppliesSubject, pKIEnrollmentAccess`

### Long-term Security Control
- Implement certificate template management policy following least privilege principles.
- Monitor for abnormal certificate requests (Event ID 4886/4887) in CA logs.
- Consider deploying Microsoft's **Certified Protection** feature for sensitive templates.

---
*This is a generic, sanitized example based on common ADCS misconfigurations. It demonstrates the structure and depth of professional finding documentation.*
